<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Capital One Breach: How a Single Misconfiguration Exposed 100M Records - CyberPulse Insights</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <a href="/cyberpulse-insights/">
                    <i class="fas fa-shield-alt"></i>
                    <span>CyberPulse <strong>Insights</strong></span>
                </a>
            </div>
            <button class="nav-toggle" aria-label="Toggle navigation"><i class="fas fa-bars"></i></button>
            <div class="nav-menu">
                <a href="/cyberpulse-insights/" class="nav-link"><i class="fas fa-home"></i> Home</a>
                <a href="/cyberpulse-insights/#threats" class="nav-link"><i class="fas fa-fire"></i> Threats</a>
                <a href="/cyberpulse-insights/#training" class="nav-link"><i class="fas fa-graduation-cap"></i> Training</a>
            </div>
        </div>
    </nav>

    <main class="container">
        <div class="post-content">
            <a href="/cyberpulse-insights/" class="back-button"><i class="fas fa-arrow-left"></i> Back to All Posts</a>
            
            <div class="post-header">
                <div class="post-meta">
                    <span class="post-date"><i class="far fa-calendar"></i> February 25, 2026</span>
                    <span class="post-category critical">Cloud Security Story</span>
                    <span class="read-time"><i class="far fa-clock"></i> 12 min read</span>
                </div>
                <h1 class="post-title">The Capital One Breach: How a Single Misconfiguration Exposed 100M Records</h1>
                <div class="post-author"><i class="fas fa-user"></i> Sarah Johnson, Cloud Security Architect</div>
                <div class="post-tags">
                    <span class="tag">AWS</span><span class="tag">S3</span><span class="tag">SSRF</span>
                    <span class="tag">WAF</span><span class="tag">IAM</span><span class="tag">$190M Fine</span>
                </div>
            </div>
            
            <div class="post-body">
                <!-- Storytelling Section -->
                <div class="story-section">
                    <div class="story-title">The $190 Million Configuration Error</div>
                    <p class="story-lead">In March 2019, a former AWS employee exploited a misconfigured web application firewall to access Capital One's AWS S3 buckets. The result: 100 million customer records exposed and one of the largest fines in cybersecurity history.</p>
                    
                    <p>Paige Thompson wasn't a sophisticated nation-state actor. She was a former AWS systems engineer who knew how cloud infrastructure worked. And when she discovered a misconfigured WAF at Capital One, she saw an opportunity.</p>
                    
                    <p>For months, she systematically extracted data: 140,000 Social Security numbers, 80,000 bank account numbers, 1 million Canadian Social Insurance numbers. All because of one misconfigured security setting.</p>
                </div>
                
                <!-- Technical Deep Dive -->
                <div class="tech-section">
                    <div class="tech-title"><i class="fas fa-code"></i> Technical Deep Dive: The Attack Chain</div>
                    
                    <h3>Step 1: The SSRF Vulnerability</h3>
                    <p>Capital One's web application had a Server-Side Request Forgery (SSRF) vulnerability. Attackers could make the server request internal AWS metadata.</p>
                    
                    <div class="code-block">
                        <pre># Vulnerable endpoint (simplified)
@app.route('/proxy')
def proxy():
    url = request.args.get('url')  # User-controlled input!
    response = requests.get(url)   # Makes request to ANY URL
    return response.text

# Attacker exploits this:
# GET /proxy?url=http://169.254.169.254/latest/meta-data/iam/security-credentials/
# Returns: IAM role credentials!</pre>
                    </div>
                    
                    <h3>Step 2: AWS Metadata Service Exploit</h3>
                    <p>AWS EC2 instances have a metadata service at 169.254.169.254 that provides IAM role credentials. The SSRF vulnerability allowed access to this.</p>
                    
                    <div class="code-block">
                        <pre># What the attacker accessed:
1. http://169.254.169.254/latest/meta-data/iam/security-credentials/
   → Returns role name
   
2. http://169.254.169.254/latest/meta-data/iam/security-credentials/ROLE-NAME
   → Returns temporary AWS credentials
   
3. Use credentials with AWS CLI:
   aws s3 ls s3://capitalone-customer-data/
   aws s3 cp s3://capitalone-customer-data/ . --recursive</pre>
                    </div>
                    
                    <h3>Step 3: The Fatal Misconfiguration</h3>
                    <p>The WAF was configured to allow requests to the metadata service. This is the single configuration error that enabled the entire breach.</p>
                    
                    <div class="code-block">
                        <pre># BAD WAF Rule (what Capital One had):
ALLOW 169.254.169.254/32

# GOOD WAF Rule (what they should have had):
BLOCK 169.254.169.254/32
BLOCK 169.254.169.0/24

# Even better: Use AWS WAF managed rule:
- AWSManagedRulesAmazonIpReputationList
- AWSManagedRulesCommonRuleSet
- Block metadata service access</pre>
                    </div>
                </div>
                
                <!-- Impact Analysis -->
                <div class="story-section">
                    <div class="story-title">The Aftermath: Numbers Tell the Story</div>
                    
                    <div class="impact-grid">
                        <div class="impact-card critical">
                            <div class="impact-card-title"><i class="fas fa-users"></i> Customer Impact</div>
                            <p><strong>100M+</strong> individuals affected<br>
                            <strong>140K</strong> Social Security numbers<br>
                            <strong>80K</strong> bank account numbers<br>
                            <strong>1M</strong> Canadian SINs</p>
                        </div>
                        <div class="impact-card warning">
                            <div class="impact-card-title"><i class="fas fa-dollar-sign"></i> Financial Cost</div>
                            <p><strong>$190M</strong> total fines and settlements<br>
                            <strong>$80M</strong> to OCC (Office of the Comptroller)<br>
                            <strong>$80M</strong> customer restitution<br>
                            <strong>$30M</strong> legal and investigation costs</p>
                        </div>
                        <div class="impact-card info">
                            <div class="impact-card-title"><i class="fas fa-gavel"></i> Legal Consequences</div>
                            <p><strong>7 years</strong> prison sentence for attacker<br>
                            <strong>3 years</strong> supervised release<br>
                            <strong>$250K+</strong> restitution ordered<br>
                            Multiple class-action lawsuits</p>
                        </div>
                        <div class="impact-card info">
                            <div class="impact-card-title"><i class="fas fa-chart-line"></i> Stock Impact</div>
                            <p><strong>5.9%</strong> stock drop after disclosure<br>
                            <strong>$3B+</strong> market cap loss initially<br>
                            <strong>2 years</strong> recovery to pre-breach levels</p>
                        </div>
                    </div>
                </div>
                
                <!-- Defense Strategies -->
                <div class="tech-section">
                    <div class="tech-title"><i class="fas fa-shield-alt"></i> Defense Strategies: Cloud Configuration Done Right</div>
                    
                    <h3>1. WAF Configuration Best Practices</h3>
                    <div class="code-block">
                        <pre># AWS WAF CloudFormation template
Resources:
  WebACL:
    Type: AWS::WAFv2::WebACL
    Properties:
      DefaultAction: { Allow: {} }
      Scope: REGIONAL
      VisibilityConfig:
        SampledRequestsEnabled: true
        CloudWatchMetricsEnabled: true
      Rules:
        - Name: BlockMetadataService
          Priority: 1
          Statement:
            IPSetReferenceStatement:
              Arn: !GetAtt MetadataServiceIPSet.Arn
          Action: { Block: {} }
          VisibilityConfig:
            SampledRequestsEnabled: true
            CloudWatchMetricsEnabled: true
  
  MetadataServiceIPSet:
    Type: AWS::WAFv2::IPSet
    Properties:
      Addresses:
        - "169.254.169.254/32"
        - "fd00:ec2::254/128"
      IPAddressVersion: IPV4
      Scope: REGIONAL</pre>
                    </div>
                    
                    <h3>2. IAM Role Security</h3>
                    <p>The breached role had S3:ListBucket and S3:GetObject permissions. Least privilege would have limited the damage.</p>
                    
                    <div class="code-block">
                        <pre># BAD IAM Policy (too permissive):
{
  "Effect": "Allow",
  "Action": "s3:*",
  "Resource": "*"
}

# GOOD IAM Policy (least privilege):
{
  "Effect": "Allow",
  "Action": [
    "s3:GetObject",
    "s3:ListBucket"
  ],
  "Resource": [
    "arn:aws:s3:::app-bucket",
    "arn:aws:s3:::app-bucket/*"
  ],
  "Condition": {
    "IpAddress": {
      "aws:SourceIp": "10.0.0.0/16"
    },
    "Bool": {
      "aws:SecureTransport": "true"
    }
  }
}</pre>
                    </div>
                    
                    <h3>3. S3 Bucket Security</h3>
                    <div class="code-block">
                        <pre># Secure S3 bucket configuration
aws s3api put-bucket-policy \
  --bucket my-bucket \
  --policy '{
    "Version": "2012-10-17",
    "Statement": [
      {
        "Effect": "Deny",
        "Principal": "*",
        "Action": "s3:*",
        "Resource": [
          "arn:aws:s3:::my-bucket",
          "arn:aws:s3:::my-bucket/*"
        ],
        "Condition": {
          "Bool": { "aws:SecureTransport": "false" }
        }
      },
      {
        "Effect": "Deny",
        "Principal": "*",
        "Action": "s3:*",
        "Resource": [
          "arn:aws:s3:::my-bucket",
          "arn:aws:s3:::my-bucket/*"
        ],
        "Condition": {
          "NotIpAddress": { "aws:SourceIp": "10.0.0.0/16" }
        }
      }
    ]
  }'

# Enable encryption and logging
aws s3api put-bucket-encryption \
  --bucket my-bucket \
  --server-side-encryption-configuration '{
    "Rules": [{
      "ApplyServerSideEncryptionByDefault": {
        "SSEAlgorithm": "AES256"
      }
    }]
  }'</pre>
                    </div>
                </div>
                
                <!-- Training Implications -->
                <div class="story-section">
                    <div class="story-title">What This Means for Cloud Security Teams</div>
                    
                    <p class="story-lead">Capital One's breach wasn't about advanced hacking techniques. It was about basic cloud security hygiene. And that's what makes it so important for every organization.</p>
                    
                    <h3>Critical Skills Gap Identified:</h3>
                    <div class="impact-grid">
                        <div class="impact-card warning">
                            <div class="impact-card-title"><i class="fas fa-cogs"></i> WAF Configuration</div>
                            <p>Understanding WAF rules, managed rule sets, and proper configuration</p>
                        </div>
                        <div class="impact-card warning">
                            <div class="impact-card-title"><i class="fas fa-user-lock"></i> IAM Security</div>
                            <p>Least privilege, role assumptions, temporary credentials</p>
                        </div>
                        <div class="impact-card warning">
                            <div class="impact-card-title"><i class="fas fa-database"></i> S3 Security</div>
                            <p>Bucket policies, encryption, logging, access controls</p>
                        </div>
                        <div class="impact-card warning">
                            <div class="impact-card-title"><i class="fas fa-search"></i> Vulnerability Management</div>
                            <p>SSRF detection, regular security assessments</p>
                        </div>
                    </div>
                    
                    <h3>Recommended Training Path:</h3>
                    <ol>
                        <li><strong>AWS Security Fundamentals</strong> (Week 1-2): IAM, S3, VPC security</li>
                        <li><strong>WAF & Network Security</strong> (Week 3-4): WAF configuration, SSRF protection</li>
                        <li><strong>Cloud Compliance</strong> (Week 5-6): Regulatory requirements, auditing</li>
                        <li><strong>Incident Response in Cloud</strong> (Week 7-8): Breach containment, forensics</li>
                    </